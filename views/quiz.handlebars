<!-- <script src="./js/quizLogic.js"></script> -->
<!-- <script>const Quiz = Handlebars.compile($(Quiz)); const Questions = Handlebars.compile($(Questions));</script> -->
<div id="box" class="p-4 m-4 container">
    <h2 class="mb-4 pb-4 text-center"> Quiz Time!</h2>
    <div>
        <h3 class="my-4 text-center"> Category: Geography </h3>

        <h4 class="text-center"> Five questions</h4>
    </div>
    <div class="bg-light">
        <p id="question" class="my-4 text-center"></p>

        <p id='answers' class="my-4 text-center"> </p>
<div class="d-flex justify-content-center">
        <input id="useranswer" type="text-area" placeholder="Answer">
</div>

        <!-- submit button checks answer and sends user to next question -->
        <div class="d-flex justify-content-center">
            <button id="submitbtn" class="btn btn-primary m-4" type="submit">Submit Answer</button>
        </div>
    </div>
    </main>

    <script type="application/javascript">
        const questionS = document.querySelector('#question');
        const answerS = document.querySelector('#answers');
        const userAnswer = document.querySelector('#useranswer');
        const submitBtn = document.querySelector('#submitbtn');

        let currentQuestionId = 0;
        let score = 0;

        async function startQuiz() {
            // Retrieve the quiz data from the server
            const quiz = await Quiz.findOne();
            const questions = await Questions.find({ quizId: quiz._id });

            // Compile the Handlebars templates
            const questionTemplate = Handlebars.compile('question');
            const answerTemplate = Handlebars.compile('answers');

            // Disimage.pngplay the first question
            displayQuestion(questions[currentQuestionId]);

            function displayQuestion(question) {
                // Render the question text using the Handlebars template
                questionS.innerHTML = questionTemplate({ question: question.text });

                // Render the answer buttons using the Handlebars template
                answerS.innerHTML = question.answers.map(answer => answerTemplate({ answer })).join('');

                // Add event listeners to the answer buttons
                const answerButtons = answerS.querySelectorAll('#answerbox');
                answerButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const cAnswer = question.answers.find(answer => answer.isCorrect);
                        if (button.textContent === cAnswer.text) {
                            score++;
                        }
                        currentQuestionId++;
                        if (currentQuestionId < questions.length) {
                            displayQuestion(questions[currentQuestionId]);
                        } else {
                            endQuiz();
                        }
                    });
                });
            }

            function endQuiz() {
                // Display the final score
                questionS.innerHTML = `You scored ${score} out of ${questions.length} questions.`;
                answerS.innerHTML = '';
                submitBtn.disabled = true;
            }
        }

        startQuiz();
    </script>